COMPONENT createDataset task

# Describes a database resource used by the component defined within this file.
# RESOURCE metadataDB dynamodb -s hashKeyName=name -s hashKeyType=S -s rangeKeyName=type -s rangeKeyType=S

# Runtime stage installs dependencies, and organize files to assist in execution of the component.
# FROM amazon/aws-cli:latest    
FROM python:3.8
WORKDIR createDataset

# copy the content of the local directory to the working directory
COPY ./ .

# install dependencies
RUN pip install awscli --upgrade
RUN wget https://github.com/stedolan/jq/releases/download/jq-1.6/jq-linux64 -O /usr/local/bin/jq && \
    echo 'af986793a515d500ab2d35f8d2aecd656e764504b789b66d7e1a0b727a124c44  /usr/local/bin/jq' | sha256sum -c && \
    chmod +x /usr/local/bin/jq
RUN pip install -r requirements.txt

# # Sets an environment variable available at build's runtime.
# ENV SOURCE_DATA_URL 'https://apps.bea.gov/regional/zip/SAEXP.zip'
# ENV S3_BUCKET 'rearc-data-provider'
# ENV DATASET_NAME 'bea-personal-consumption-expenditures-by-state'
# ENV DATASET_ARN ''
# ENV DATASET_ID ''
# ENV PRODUCT_NAME 'BEA - Personal Consumption Expenditures (PCE) by State'
# ENV PRODUCT_ID 'BLANK'
# ENV REGION 'us-east-1'

# Sets environment variables for runtime. The variables available from a defined resource vary depending on the type of the resource.
# ENV DYNAMO_TABLE $.resources.mobilityDB.tableName
# ENV DYNAMO_ENDPOINT $.resources.mobilityDB.endpoint

RUN chmod a+x ./bin/*
# RUN ./bin/run-script.sh

# command to run on container start
CMD [ "/bin/bash", "./bin/run-script.sh" ]

CRON 0 0 * * *

# Specifies when this task component will run. BeforeTraffic means this task will run immediately after all other components have been deployed.
LIFECYCLE beforeStartingServices